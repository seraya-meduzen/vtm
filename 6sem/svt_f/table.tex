\input{preamble}

\begin{document}
	\tableofcontents
	
	\section{Постановка задачи}
	
	 Требуется решить разреженную систему матриц хранящихся в формате CSR.
	 
	  Для этого использовалась библиотека SPARSKIT (Fortran). Ее функционал позволяет загрузить матрицу в указанном фрмате, создать переобуславливатель и запустить GMRES.
Требуется замерить время построения переобуславливателя, GMRES, а также число итераций. В качестве правой части используется $b_i = sin(i)$. Параметр точности GMRES $\epsilon = 10^{-8}$. Параметр переобуславливателя $k = 0$. Количество крыловских пространств в GMRES равно 10.

	\section{Результаты}
	
	Функция замера времени: $cpu \_ time()$. Код выполнялся на  4 ядерном процессоре (8 с потоками).
	
	Компилятор gfortran с флагами оптимизации -flto -Ofast -march=native.
	
\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		Size  & ILU Time [s] & PGMRES Time [s] & Iterations\\ \hline
		4127 & 0.007 &  0.052  & 315 \\ 
		\hline
		16527 & 0.025 & 7.450 & 584 \\
		\hline
		66159 & 0.090 & 99.836 & 1722\\
		\hline
		264751 & 0.351 & 733.469 & 3171\\
		\hline	
	\end{tabular}
	\caption{Время работы функций}
	\label{table:1}
\end{table}
	
	\section{Выводы}
	
	Асимптотику ILU можно считать порядка $O(n)$. 
	
	Время работы PGMRES резко скачет, как и число итераций. Это связано с особенностями конкретных матриц. Приближенно можно считать время работы PGMRES $O(n^1.85)$. Число итераций можно считать порядка $O(n^{\frac{1}{2}})$.	
\end{document}


%\begin{table}
%\begin{center}
%\begin{tabular}{|c|c|c|c|}
%\hline
%Size  & ILU Time [s] & PGMES Time [s] & Iterations\\ \hline
%4127 & 0.007 &  0.052  & 315 \\ \hline
%16527 & 0.025 & 7.450 & 584 \\
%\hline
%66159 & 0.090 & 99.836 & 1722\\
%\hline
%264751 & 0.351 & 733.469 & 3171\\
%\hline
%\end{tabular}
%\end{center}
%\end{table}
